<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- NO CACHE -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <title>Red Fetch</title>

    <style>
        /* Version box styling */
        #versionBox {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(150,180,255,0.12);
            color: #b7d9ff;
            padding: 10px 14px;
            border-radius: 10px;
            font-size: 10px;
            line-height: 14px;
            border: 1px solid rgba(180,210,255,0.25);
            text-align: right;
        }
    </style>

    <!-- CSS (cache-busted) -->
    <link id="mainCSS" rel="stylesheet" href="assets/main.css?v=1">
</head>

<body>

    <h1 id="titleHeader">Red Fetch</h1>

    <div id="versionBox"></div>

    <!-- TOP BAR -->
    <div class="top-bar" style="
        display:flex;
        align-items:center;
        gap:12px;
        margin:20px;
    ">

        <!-- u/ r/ selector -->
        <select id="modeSelect" class="modeSelect" style="
            font-size:14px;
            padding:6px 10px;
            height:36px;
            border-radius:6px;
        ">
            <option value="u">u/</option>
            <option value="r">r/</option>
        </select>

        <!-- Search field (smaller width) -->
        <input id="input" class="input" type="text" placeholder="User ID or URL here" 
            style="
                font-size:14px;
                padding:8px 12px;
                height:36px;
                width:50%;
                border-radius:6px;
                background:#111;
                color:#eee;
                border:1px solid #2b2d31;
            ">

        <!-- Load Posts button (moved LEFT) -->
        <button id="loadBtn" class="loadBtn" style="
            font-size:14px;
            padding:8px 14px;
            height:36px;
            border-radius:6px;
        ">Load Posts</button>

    </div>

    <!-- BUTTON ROW -->
    <div class="button-row" style="
        display:flex;
        align-items:center;
        gap:12px;
        margin:20px;
        flex-wrap:wrap;
    ">
        <button id="copyBtn" style="font-size:14px; padding:8px 14px; height:36px;">Copy URL</button>
        <button id="clearBtn" style="font-size:14px; padding:8px 14px; height:36px;">Clear</button>

        <label><input type="checkbox" id="imagesChk" checked> Images</label>
        <label><input type="checkbox" id="videosChk" checked> Videos</label>
        <label><input type="checkbox" id="otherChk" checked> Other</label>

        <button id="colToggleBtn" style="font-size:14px; padding:8px 14px; height:36px;">Columns: 3</button>

        <button id="zipBtn" style="font-size:14px; padding:8px 14px; height:36px;">Download ZIP</button>
    </div>

    <div id="results"></div>

    <!-- Scroll To Top -->
    <button id="scrollTopBtn" style="
        position:fixed;
        bottom:23px;
        left:23px;
        background:#83f3df;
        border:none;
        padding:10px 16px;
        border-radius:50px;
        font-size:14px;
        cursor:pointer;
        z-index:3000;
    ">Top</button>

    <!-- JS (cache bust) -->
    <script id="mainJS" src="assets/app.js?v=1"></script>

    <!-- Runtime cache bypass -->
    <script>
        (function() {
            const ts = Date.now();
            document.getElementById("mainCSS").href = "assets/main.css?v=" + ts;
            document.getElementById("mainJS").src  = "assets/app.js?v=" + ts;
        })();
    </script>

    <!-- Auto-version box -->
    <script>
    (async function autoVersionBox() {
        const box = document.getElementById("versionBox");
        if (!box) return;

        async function getVersion(url) {
            try {
                const res = await fetch(url + "?t=" + Date.now());
                const text = await res.text();
                const m = text.match(/Version\s+(v[\d.]+)/i);
                return m ? m[1] : "unknown";
            } catch {
                return "error";
            }
        }

        const cssVer = await getVersion("assets/main.css");
        const jsVer  = await getVersion("assets/app.js");

        // Index version â€” we do NOT show it in title anymore
        const indexVer = cssVer; // synced version

        box.innerHTML =
            `Index ${indexVer}<br>` +
            `CSS ${cssVer}<br>` +
            `JS ${jsVer}`;
    })();
    </script>

</body>
</html>
