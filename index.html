<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- NO-CACHE HEADERS -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <title>Red Fetch</title>

    <!-- VERSION BOX -->
    <style>
        #versionBox {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(150, 180, 255, 0.15);
            color: #b7d9ff;
            padding: 8px 10px;
            border-radius: 10px;
            font-size: 6pt;                     /* << SHRUNK */
            line-height: 1.3;
            border: 1px solid rgba(180, 210, 255, 0.35);
            text-align: right;
        }
    </style>

    <!-- Load CSS -->
    <link id="mainCSS" rel="stylesheet" href="assets/main.css?v=1">
</head>

<body>

    <h1 id="titleHeader">Red Fetch</h1>

    <div id="versionBox">
        Index v…<br>
        CSS v…<br>
        JS v…
    </div>

    <div class="top-bar">
        <select id="modeSelect" class="modeSelect">
            <option value="u">u/</option>
            <option value="r">r/</option>
        </select>

        <input id="input" class="input" type="text" placeholder="User ID or URL here">
        <button id="loadBtn" class="loadBtn">Load Posts</button>
    </div>

    <div class="button-row">
        <button id="copyBtn">Copy URL</button>
        <button id="clearBtn">Clear</button>

        <label><input type="checkbox" id="imagesChk" checked> Images</label>
        <label><input type="checkbox" id="videosChk" checked> Videos</label>
        <label><input type="checkbox" id="otherChk" checked> Other</label>

        <button id="colToggleBtn">Columns: 3</button>

        <button id="zipBtn">Download ZIP</button>
    </div>

    <div id="results"></div>

    <button id="scrollTopBtn">Top</button>

    <!-- JS -->
    <script id="mainJS" src="assets/app.js?v=1"></script>

    <!-- Auto inject version numbers -->
    <script>
        (function () {
            const ts = Date.now();

            // Update CSS + JS cache-buster
            document.getElementById("mainCSS").href = "assets/main.css?v=" + ts;
            document.getElementById("mainJS").src   = "assets/app.js?v=" + ts;

            // Get version from app.js comment header
            fetch("assets/app.js?v=" + ts)
                .then(r => r.text())
                .then(txt => {
                    const match = txt.match(/Version (v[0-9.]+)/);
                    const jsVer = match ? match[1] : "v?";

                    const cssVer = "v" + (document.getElementById("mainCSS").href.split("v=")[1] || "?");
                    const idxVer = jsVer; // You want them all matched automatically

                    document.getElementById("versionBox").innerHTML =
                        `Index ${idxVer}<br>CSS ${cssVer}<br>JS ${jsVer}`;

                    // Also update header text:
                    document.getElementById("titleHeader").textContent = "Red Fetch " + jsVer;
                });
        })();
    </script>

</body>
</html>
